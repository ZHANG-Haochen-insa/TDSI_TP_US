# TP 超声断层扫描 - 简要答案

## 第1部分：A-scan矩阵的设置和采集

### 问题1：请说明选择物体平移来实现A-scan的理由

**简答：**
- 机械简化：移动小物体比移动整个收发系统更简单精确
- 几何稳定性：固定探测器保证发射器和接收器对齐恒定，减少误差
- 平行几何：物体平移确保投影线保持平行，满足平行束断层扫描要求
- 成本效益：移动物体的机械系统更经济
- 校准简便：固定换能器位置使系统校准更容易

---

### 问题2：凝胶有什么用？如果凝胶分布不均，可能会出现什么问题？

**简答：**

**凝胶的作用：**
- 阻抗匹配：减少空气/固体界面的声阻抗突变
- 消除气隙：填充换能器和水箱壁之间的空隙
- 减少反射损失：空气界面会反射99.9%的超声能量
- 提高耦合效率：确保声能有效传输

**凝胶分布不均的问题：**
- 信号强度不均匀，产生伪影
- 衰减系数提取出现系统误差
- 某些位置信号质量严重下降
- 重建图像质量不一致

---

### 问题3：如果水箱宽度为14厘米（水中声速=1500 m/s），计算发射信号的理论到达时间

**计算：**
```
t = d / c = 0.14 m / 1500 m/s = 93.3 μs
```

**答案：93.3 微秒**

---

### 问题4：计算为创建A-scan矩阵将要执行的N次采集的数量（样本直径60mm，步长5mm）

**计算：**
```
N = (60 mm / 5 mm) + 1 = 13
```

**答案：13次采集**

---

## 第2部分：在Matlab中读取A-scan矩阵并提取断层扫描的可观测量

### 问题5：显示A-scan矩阵及其包络（以dB表示）

**方法：**
1. 读取所有信号文件构建矩阵
2. 计算包络：`envelope = abs(hilbert(signal))`
3. 转换为dB：`envelope_dB = 20*log10(envelope)`
4. 用`imagesc()`显示

**实验结果描述：**

我们采用了两种可视化方法：
- **二维显示**：使用`imagesc`将13次采集的信号以彩色图像形式展示，横轴为时间采样点，纵轴为平移位置
- **一维对比显示**：将13次采集逐个展示，左侧为RF射频信号，右侧为对应的包络信号

图像中可以清晰观察到信号到达时间约在93微秒处，物体区域的信号衰减明显。

---

### 问题6a：提出一个可以从A-scan原始信号中表示衰减项 ∫μ(x,y)dl 的量

**简答：**

根据声波衰减公式：A = A₀ exp(-∫μ(x,y)dl)

取对数得：∫μ(x,y)dl = ln(A₀/A)

**可观察量：**
- **Observable = -ln(A_received / A_reference)**
- 或 **Observable = ln(A₀ / A)**

其中：
- A_received：通过物体后的信号幅度（包络峰值）
- A_reference：参考幅度（无物体时的信号）

**实际实现**：提取每个A-scan的包络最大值，与参考值比较后取对数

---

### 问题6b：提取幅度并与GS-EchoView比较

**方法：**
1. 从每个A-scan提取最大幅度或包络峰值
2. 转换为dB：`amp_dB = 20*log10(amp)`
3. 与`amp_extraites`对比绘图
4. 计算平均误差和标准差

**实验结果描述：**

- 取每次采集信号的最大值构成向量A
- 进行一次空白采集，取其最大值作为参考A₀
- 制造商软件默认使用A₀=1作为参考

**对比图描述：** 图中显示两条曲线：
- **蓝色曲线**：我们的实验测量结果
- **红色曲线**：制造商软件的数据

两条曲线趋势一致，但存在一个固定的**垂直偏移（offset）**，这是因为参考值A₀选取不同导致的。

---

## 第3部分：使用GS-EchoView记录幅度和进行断层扫描

### 问题7：物体完成一次完整旋转，计算将执行的R次旋转的次数（角度步长16.2°）

**计算：**
```
R = 360° / 16.2° = 22.22
```

**答案：22次旋转（或23次采集，含起始位置）**

---

### 问题8：使用更多的角度会有什么效果？

**简答：**

**正面效果：**
- 提高角度分辨率，减少条纹伪影
- 改善图像质量，边界更清晰
- 提高小结构检测能力
- 减少欠采样效应

**负面影响：**
- 增加采集时间和数据量
- 可能增加噪声累积

**结论：**使用更多角度会显著提高重建图像质量，但需要权衡采集时间

---

### 问题9：计算断层扫描的总测量次数（旋转22次，平移步长2mm，扫描长度60mm）

**计算：**
```
每次旋转的采集次数：N = 60/2 + 1 = 31
总测量次数 = 22 × 31 = 682
```

**答案：682次测量**

---

### 问题10：评论所获得的结果

**实验结果描述：**

在重建图像中，我们观察到圆柱体物体内部存在**3个不同的区域**，各区域对超声波的衰减程度不同。这表明物体内部由不同材料组成，它们具有不同的声学特性。

**评估要点：**
- 几何准确性：物体直径约60mm，形状正确
- 内部结构：清晰可见3个不同衰减区域
- 伪影分析：22个角度会产生轻微条纹伪影
- 改进建议：增加角度和平移采样密度

---

### 问题11：如何获得更好的断层扫描结果？

**简答：**

**1. 采样参数优化：**
- 增加角度数量（从22个增至180个或更多）
- 减小平移步长（从2mm减至1mm或0.5mm）
- 提高时间采样率

**2. 硬件改进：**
- 使用更高频率换能器
- 改善对齐精度和机械稳定性
- 确保凝胶均匀涂抹

**3. 信号处理：**
- 降噪滤波
- 信号平均减少随机噪声
- 自动增益控制

**4. 重建算法：**
- 使用滤波反投影（FBP）
- 选择合适滤波器（Shepp-Logan, Hamming等）
- 使用迭代重建算法（ART, SART）

**5. 校准和补偿：**
- 几何校准确定旋转中心
- 水衰减补偿
- 束硬化校正

---

## 第4部分：Matlab中的断层扫描

### 问题12：显示可观察量的矩阵

**方法：**
- 正弦图（sinogram）：31×23矩阵
- 每列对应一个角度的投影
- 用`imagesc(sinogram)`显示

**实验结果描述：**

使用`imagesc`显示的采集矩阵为**31行×23列**：
- 31行对应31个不同的平移位置
- 23列对应23个不同的旋转角度

图像呈现典型的正弦图特征，物体的投影位置随旋转角度呈正弦变化。图中可以看到不同亮度带，反映了3个不同衰减区域在各角度投影的叠加效果。

---

### 问题13：使用iradon函数实现断层扫描并比较

**方法：**
```matlab
theta = 0:16.2:(22-1)*16.2;
reconstruction = iradon(sinogram, theta, 'Shepp-Logan', 'spline', size(sinogram,1));
```

**实验结果描述：**

使用`iradon`进行逆Radon变换重建断层图像，成功还原了物体内部的**3个衰减区域**。

**不同插值和滤波器的对比：**

1. **线性插值（默认）**：重建图像清晰显示3个衰减区域，边界可辨识

2. **样条插值（spline）**：结果与线性插值非常接近，过渡更平滑，但整体差异不大

3. **Shepp-Logan滤波器**：相比默认滤波器，该滤波器能**更好地分离不同区域**，边界更加清晰锐利

**结论：** 滤波处理会影响边缘信息的保留。Shepp-Logan滤波器在区域分离方面效果更好，但可能损失部分轮廓细节。
